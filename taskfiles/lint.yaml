version: "3"

includes:
  cmake:
    flatten: true
    taskfile: "./lint-cmake.yaml"
  cpp:
    flatten: true
    taskfile: "./lint-cpp.yaml"
  venv:
    flatten: true
    taskfile: "./lint-venv.yaml"
  yaml:
    flatten: true
    taskfile: "./lint-yaml.yaml"

vars:
  # General variables
  G_EXAMPLES_SRC_DIR: "{{.ROOT_DIR}}/examples/src"
  G_YSTDLIB_SRC_DIR: "{{.ROOT_DIR}}/src"

  # Lint variables
  G_LINT_CPP_ROOT_DIRS:
    - "{{.G_EXAMPLES_SRC_DIR}}"
    - "{{.G_YSTDLIB_SRC_DIR}}"
  G_LINT_VENV_DIR: "{{.G_BUILD_DIR}}/lint-venv"
  G_LINT_VENV_CHECKSUM_FILE: "{{.G_BUILD_DIR}}/lint#venv.md5"

tasks:
  check:
    desc: "Runs the full suite of linters to identify warnings and violations."
    cmds:
      - task: "cmake-check"
      - task: "cpp-check"
      - task: "yaml-check"

  fix:
    desc: "Runs the full suite of linters and fixes some violations."
    cmds:
      - task: "cmake-fix"
      - task: "cpp-fix"
      - task: "yaml-fix"
