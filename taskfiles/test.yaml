version: "3"

includes:
  ystdlib:
    internal: true
    taskfile: "ystdlib.yaml"

vars:
  G_UNIT_TEST_ALL: "testbin/unit-test-all"

tasks:
  run-debug:
    # The name ystdlib_LIBRARIES should match its CMakeLists.txt equivalent for consistency.
    desc: >-
      debug [ystdlib_LIBRARIES="<lib0;...;libn>"]: Run unit tests for debug libraries. If
      ystdlib_LIBRARIES is defined, only configure and build the listed libraries and their internal
      dependencies.
    deps:
      - task: "ystdlib:build-debug"
        vars:
          ystdlib_LIBRARIES: "{{.ystdlib_LIBRARIES}}"
    cmds:
      - "'{{.G_YSTDLIB_DEBUG_BUILD_DIR}}/{{.G_UNIT_TEST_ALL}}'"

  run-release:
    # The name ystdlib_LIBRARIES should match its CMakeLists.txt equivalent for consistency.
    desc: >-
      release [ystdlib_LIBRARIES="<lib0;...;libn>"]: Run unit tests for release libraries. If
      ystdlib_LIBRARIES is defined, only configure and build the listed libraries and their internal
      dependencies.
    deps:
      - task: "ystdlib:build-release"
        vars:
          ystdlib_LIBRARIES: "{{.ystdlib_LIBRARIES}}"
    cmds:
      - "'{{.G_YSTDLIB_RELEASE_BUILD_DIR}}/{{.G_UNIT_TEST_ALL}}'"
